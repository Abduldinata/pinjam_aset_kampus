{{ define "admin/reports.html" }}
<!DOCTYPE html>
<html>
<head>
    <title>Laporan Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background-color: #f3f4f6; overflow-x: hidden; }
        .sidebar { height: 100vh; width: 260px; position: fixed; top: 0; left: 0; background: #1e293b; color: white; padding-top: 20px; z-index: 1000; }
        .sidebar-header { padding: 0 20px 20px; border-bottom: 1px solid #334155; margin-bottom: 20px; }
        .sidebar-brand { font-size: 1.5rem; font-weight: bold; color: #3b82f6; text-decoration: none; }
        .nav-link { color: #cbd5e1; padding: 12px 20px; font-size: 1rem; transition: 0.3s; display: flex; align-items: center; }
        .nav-link:hover { background: #334155; color: white; }
        .nav-link.active { background: #2563eb; color: white; border-right: 4px solid #60a5fa; }
        .nav-link i { width: 25px; margin-right: 10px; text-align: center; }
        .main-content { margin-left: 260px; padding: 30px; }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="sidebar-header"><a href="#" class="sidebar-brand">Admin Panel</a></div>
        <nav class="nav flex-column">
            <a href="/admin/dashboard" class="nav-link"><i class="fas fa-home"></i> Dashboard</a>
            <a href="/admin/items" class="nav-link"><i class="fas fa-box"></i> Data Barang</a>
            <a href="/admin/loans" class="nav-link"><i class="fas fa-clipboard-list"></i> Riwayat Peminjaman</a>
            <a href="/admin/reports" class="nav-link active"><i class="fas fa-file-alt"></i> Laporan</a> <a href="/logout" class="nav-link text-danger mt-4"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </nav>
    </div>

    <div class="main-content">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-white py-3">
                <h4 class="mb-0 fw-bold"><i class="fas fa-file-alt me-2 text-primary"></i>Laporan Peminjaman</h4>
            </div>
            <div class="card-body">
                
                <form method="GET" action="/admin/reports" class="row g-3 mb-4 p-3 bg-light rounded border">
                    <div class="col-md-4">
                        <label class="form-label fw-bold small">Filter Mahasiswa</label>
                        <select name="user_id" class="form-select">
                            <option value="">-- Semua Mahasiswa --</option>
                            {{ range .Users }}
                            <option value="{{ .ID }}" {{ if eq (printf "%d" .ID) $.SelectedUser }}selected{{ end }}>
                                {{ .Name }}
                            </option>
                            {{ end }}
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label fw-bold small">Filter Bulan</label>
                        <input type="month" name="month" class="form-control" value="{{ .SelectedMonth }}">
                    </div>
                    <div class="col-md-4 d-flex align-items-end">
                        <button type="submit" class="btn btn-primary w-100"><i class="fas fa-filter me-2"></i>Tampilkan Laporan</button>
                    </div>
                </form>

                <table class="table table-bordered align-middle">
                    <thead class="table-secondary">
                        <tr>
                            <th>No</th>
                            <th>Peminjam</th>
                            <th>Barang</th>
                            <th>Tgl Pinjam</th>
                            <th>Tgl Kembali</th>
                            <th>Status</th>
                            <th>Catatan</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{ range $index, $loan := .Loans }}
                        <tr>
                            <td>{{ $index }}</td>
                            <td>{{ .User.Name }}</td>
                            <td>{{ .Item.Name }}</td>
                            <td>{{ .BorrowDate.Format "02 Jan 2006" }}</td>
                            <td>
                                {{ if .ReturnDate }}
                                    {{ .ReturnDate.Format "02 Jan 2006" }}
                                {{ else }}
                                    -
                                {{ end }}
                            </td>
                            <td>
                                {{ if eq .Status "dipinjam" }} <span class="badge bg-warning text-dark">Dipinjam</span>
                                {{ else if eq .Status "kembali" }} <span class="badge bg-success">Kembali</span>
                                {{ else }} <span class="badge bg-danger">Terlambat</span> {{ end }}
                            </td>
                            <td>{{ .Notes }}</td>
                        </tr>
                        {{ else }}
                        <tr><td colspan="7" class="text-center py-3">Tidak ada data.</td></tr>
                        {{ end }}
                    </tbody>
                </table>
                
                <button onclick="window.print()" class="btn btn-dark mt-3">
                    <i class="fas fa-print me-2"></i> Cetak PDF
                </button>
            </div>
        </div>
    </div>
</body>
</html>
{{ end }}